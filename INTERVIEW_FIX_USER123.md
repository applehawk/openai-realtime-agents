# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å userId="user123"

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ò–Ω—Ç–µ—Ä–≤—å—é —É–∂–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å —Ä–∞–Ω–µ–µ. –í–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.", —Ö–æ—Ç—è –æ–Ω–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –∏–Ω—Ç–µ—Ä–≤—å—é. 

–í –ª–æ–≥–∞—Ö –±—ã–ª–æ –≤–∏–¥–Ω–æ, —á—Ç–æ –∞–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `userId="user123"` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `fdb2b0dd-b19c-4b1b-b8e9-33acdddd18ae`).

## üîç –ü—Ä–∏—á–∏–Ω–∞

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: API `/api/session` –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Å—Å–∏–∏ Realtime Agent. –ê–≥–µ–Ω—Ç –Ω–µ –∑–Ω–∞–ª, –∫—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–∫–æ–µ-—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∏–Ω—Ç–µ—Ä–≤—å—é –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö –∞–≥–µ–Ω—Ç–∞ –±—ã–ª–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç—Ä–æ–≥–æ–π –∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª–∞ –≤—Å–µ —Ç–∏–ø—ã –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç RAG API.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ü–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ —Å–µ—Å—Å–∏—é

–û–±–Ω–æ–≤–∏–ª–∏ `/api/session/route.ts` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:

```typescript
// –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏–∑ cookies
const cookieStore = await cookies();
const accessToken = cookieStore.get('access_token')?.value;

let userInfo = null;
if (accessToken) {
  try {
    const user = await authClient.getCurrentUser(accessToken);
    userInfo = {
      userId: user.id,
      username: user.username,
      email: user.email,
      position: user.username || '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç',
    };
  } catch (error) {
    console.error('Failed to get user info:', error);
  }
}

// –ü–µ—Ä–µ–¥–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Å—Å–∏–∏
const sessionConfig = JSON.stringify({
  session: {
    type: "realtime",
    model: "gpt-realtime",
    audio: {
      output: { voice: "marin" },
    },
    ...(userInfo && {
      instructions: `User profile: ID=${userInfo.userId}, Username=${userInfo.username}, Position=${userInfo.position}`,
    }),
  },
});
```

### 2. –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∏–Ω—Ç–µ—Ä–≤—å—é

–û–±–Ω–æ–≤–∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `checkInterviewStatus` –∏ `startInitialInterview` –≤ `interviewTools.ts`:

```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤—å—é –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ
if (response && response.response && 
    !response.response.includes('–Ω–µ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π') &&
    !response.response.includes('No relevant context found') &&
    !response.response.includes('–Ω–µ –Ω–∞–π–¥–µ–Ω–æ') &&
    response.response.length > 50) {
  return {
    hasInterview: true,
    message: '–ò–Ω—Ç–µ—Ä–≤—å—é —É–∂–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å —Ä–∞–Ω–µ–µ. –í–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.',
  };
}
```

### 3. –£–ª—É—á—à–µ–Ω–∏–µ API –∏–Ω—Ç–µ—Ä–≤—å—é

–û–±–Ω–æ–≤–∏–ª–∏ `/api/interview/route.ts` –¥–ª—è –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```typescript
// –ù–µ –ø–æ–ª–∞–≥–∞–µ–º—Å—è –Ω–∞ —Ñ–ª–∞–≥ has_data, –∞ –¥–µ–ª–∞–µ–º –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å
const interviewData = await callRagApiDirect('/query', 'POST', {
  query: `–∏–Ω—Ç–µ—Ä–≤—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId}`,
  mode: 'local',
  top_k: 1,
  workspace: workspaceName,
});

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤—å—é
if (interviewData && interviewData.response && 
    !interviewData.response.includes('–Ω–µ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π') &&
    !interviewData.response.includes('No relevant context found') &&
    !interviewData.response.includes('–Ω–µ –Ω–∞–π–¥–µ–Ω–æ') &&
    interviewData.response.length > 50) {
  return NextResponse.json({
    hasInterview: true,
    message: '–ò–Ω—Ç–µ—Ä–≤—å—é —É–∂–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å',
    interviewData: interviewData.response,
  });
}
```

## üìã –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`src/app/api/session/route.ts`**
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `cookies` –∏ `authClient`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Å—Å–∏–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–±–∞ –º–µ—Ç–æ–¥–∞: `POST` –∏ `GET`

2. **`src/app/agentConfigs/severstalAssistantAgent/interviewTools.ts`**
   - –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `checkInterviewStatus`
   - –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `startInitialInterview`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ "No relevant context found"

3. **`src/app/api/interview/route.ts`**
   - –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `checkInterviewStatus`
   - –£–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ–ª–∞–≥–∞ `has_data`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ "No relevant context found"

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å:
- ‚úÖ –ê–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `userId` –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞–∫ –Ω–µ –ø—Ä–æ—à–µ–¥—à–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–æ—à–µ–¥—à–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Å–µ—Å—Å–∏—é –∞–≥–µ–Ω—Ç–∞
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∏–Ω—Ç–µ—Ä–≤—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∞–≥–µ–Ω—Ç—É
4. –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø—Ä–æ–π—Ç–∏ –∏–Ω—Ç–µ—Ä–≤—å—é (–Ω–µ –≥–æ–≤–æ—Ä–∏—Ç—å, —á—Ç–æ –æ–Ω–æ —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω–æ)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ü—Ä–æ–π–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤—å—é
2. –û—Ç–∫–ª—é—á–∏—Ç–µ—Å—å –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —Å–Ω–æ–≤–∞
3. –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–æ–±—â–∏—Ç—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä–≤—å—é —É–∂–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ

## üîë –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

- **–ü–µ—Ä–µ–¥–∞—á–∞ userId**: –¢–µ–ø–µ—Ä—å –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**: –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∏–µ –æ—Ç–≤–µ—Ç–∞, –Ω–æ –∏ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤**: –£—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç RAG API (—Ä—É—Å—Å–∫–∏–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
- **–î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞**: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (>50 —Å–∏–º–≤–æ–ª–æ–≤)

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü—Ä–æ–±–ª–µ–º–∞ —Å `userId="user123"` –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞. –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–µ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.

